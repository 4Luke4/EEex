
;------------------------------------
;-- Pre-Main-Thread-Resume Patches --
;------------------------------------

[PleaseDontBreakMyConsole1]
Pattern=40554883EC30488D6C2430
Operations=ADD 43, DISABLE_CODE_PROTECTION, WRITE BYTES B80100000090, ENABLE_CODE_PROTECTION

[PleaseDontBreakMyConsole2]
Pattern=7552488BCB
Operations=DISABLE_CODE_PROTECTION, WRITE BYTES EB, ENABLE_CODE_PROTECTION

;--------------------------
;-- Bound Engine Globals --
;--------------------------

[CAIObjectType::NOONE]
Pattern=E988040000
Operations=ADD 15, PUSH, READ DWORD, ADD, ADD 4

[CGameObject::DEFAULT_TERRAIN_TABLE]
Pattern=480FBFC085C0786A
Operations=ADD 71, PUSH, READ DWORD, ADD, ADD 4

[CVidMode::SCREENHEIGHT]
Pattern=0F5BD2660F6EC1
Operations=ADD -4, PUSH, READ DWORD, ADD, ADD 4

[CVidMode::SCREENWIDTH]
Pattern=0F5BD2660F6EC1
Operations=ADD -26, PUSH, READ DWORD, ADD, ADD 4

[capture]
Pattern=756633C0
Operations=ADD 7, PUSH, READ DWORD, ADD, ADD 4

[g_lua]
Pattern=4885C00F85DA000000
Operations=ADD 12, PUSH, READ DWORD, ADD, ADD 4

[g_pBaldurChitin]
Pattern=48895C2430488B5E10
Operations=ADD 30, PUSH, READ DWORD, ADD, ADD 4

[menuLength]
Pattern=3D020400000F8556010000
Operations=ADD 14, PUSH, READ DWORD, ADD, ADD 4

[menuSrc]
Pattern=3D020400000F8556010000
Operations=ADD 33, PUSH, READ DWORD, ADD, ADD 4

[menuStack]
Pattern=85C00F8E01010000
Operations=ADD 23, PUSH, READ DWORD, ADD, ADD 4

[menus]
Pattern=41B800700000
Operations=ADD -4, PUSH, READ DWORD, ADD, ADD 4

[nextStackMenuIdx]
Pattern=7E03FFC8
Operations=ADD -6, PUSH, READ DWORD, ADD, ADD 4

[numMenus]
Pattern=41B800700000
Operations=ADD 59, PUSH, READ DWORD, ADD, ADD 4

[resources]
Pattern=488B1CFB4885DB745B
Operations=ADD -4, PUSH, READ DWORD, ADD, ADD 4, ADD -8

;----------------------------
;-- Bound Engine Functions --
;----------------------------

[C2DArray::Construct]
Pattern=488D542420488937
Operations=ADD -51

[C2DArray::Destruct]
Pattern=40574883EC20488B4110

[C2DArray::GetAtLabels]
Pattern=48895C2410565741564883EC20

[C2DArray::Load]
Pattern=488BEC4883EC50488B4110
Operations=ADD -11

[CAIAction::Construct1]
Pattern=48897C242041564881ECF0000000
Operations=ADD -10

[CAIAction::ConstructCopy]
Pattern=4883C208488901
Operations=ADD -33

[CAIAction::Decode]
Pattern=488BFA4883C108
Operations=ADD -13

[CAIAction::Destruct]
Pattern=488D5348488D4DD8
Operations=ADD -4, PUSH, READ DWORD, ADD, ADD 4

[CAIAction::operator_equ]
Pattern=0FB702488BDA
Operations=ADD -10

[CAIGroup::AddToSearch]
Pattern=488B59104885DB0F84DE000000
Operations=ADD -6

[CAIGroup::FollowLeader]
Pattern=4889542410555657488BEC

[CAIGroup::GetFacings]
Pattern=5556574154415541574883EC30
Operations=ADD -2

[CAIGroup::GetOffsets]
Pattern=48895C24086689542410

[CAIGroup::GroupSetTarget1]
Pattern=488954241055534155

[CAIGroup::RemoveFromSearch]
Pattern=4885DB0F84D6000000
Operations=ADD -10

[CAIIdList::Construct1]
Pattern=4889442428488BF94883C110
Operations=ADD -20

[CAIIdList::Destruct]
Pattern=488B5928488BF1488901
Operations=ADD -18

[CAIIdList::Find1]
Pattern=837958007415

[CAIIdList::LoadList2]
Pattern=48895C24184889542410574883EC20

[CAIObjectType::OfType]
Pattern=415441574883EC30488BFA
Operations=ADD -4

[CAIObjectType::Set]
Pattern=0FB64208884108

[CAIScript::Construct1]
Pattern=48895424105556574883EC40
Operations=ADD -5

[CAIScriptFile::Construct]
Pattern=48895C241848896C242056574154415641574883EC20

[CAIScriptFile::Destruct]
Pattern=488B7908488BD9
Operations=ADD -10

[CAIScriptFile::ParseResponseString]
Pattern=B802000000C7470400000000
Operations=ADD -30

[CChitin::OnResizeWindow]
Pattern=48895C2420565741564883EC30

[CDerivedStats::GetSpellState]
Pattern=81FA000100007320

[CGameAIBase::GetTargetShare]
Pattern=4883EC20488BF94533C0
Operations=ADD -6

[CGameArea::AdjustTarget]
Pattern=48895C240844884C2420

[CGameArea::CheckLOS]
Pattern=4C894C242053574156

[CGameArea::CheckWalkable]
Pattern=4C894C24204C894424185556574154
Operations=ADD -5

[CGameArea::GetNearest]
Pattern=4881ECE80000000F29B424D0000000
Operations=ADD -18

[CGameArea::GetNearest2]
Pattern=6644894C24204C89442418

[CGameEffect::DecodeEffect]
Pattern=5741564883EC4033DB
Operations=ADD -11

[CGameObjectArray::GetShare]
Pattern=48C7020000000083F9FF

[CGameSprite::FeedBack]
Pattern=48895C24105556574154415541564157488D6C24F9

[CGameSprite::GetActiveStats]
Pattern=488D81C81D0000C3
Operations=ADD -16

[CGameSprite::GetInternalButtonList]
Pattern=4056415641574883EC50

[CGameSprite::GetKitMask]
Pattern=84C87476
Operations=ADD -39

[CGameSprite::GetLauncherSlot]
Pattern=574883EC20480FBFC2
Operations=ADD -10

[CGameSprite::GetQuickButtons]
Pattern=48895C242055565741544156488D6C24C9

[CGameSprite::PlaySound]
Pattern=535741554156488D6C24D1
Operations=ADD -2

[CGameSprite::ReadyOffInternalList]
Pattern=48894570488BF9410FB6D8
Operations=ADD -33

[CGameSprite::ReadySpell]
Pattern=5657488D6C2480
Operations=ADD -6

[CGameSprite::UpdateTarget]
Pattern=488BD94885D2740F
Operations=ADD -13

[CImmunitiesAIType::OnList]
Pattern=4889742410574883EC30488B5908
Operations=ADD -5

[CInfButtonArray::SetQuickSlot]
Pattern=48896C24104889742418574881ECE0000000

[CInfButtonArray::SetState]
Pattern=4889442430448BFA
Operations=ADD -38

[CInfGame::SetIconIndex]
Pattern=889138400000
Operations=ADD -21

[CInfGame::SetState]
Pattern=4489814C400000
Operations=ADD -9

[CObList::AddTail]
Pattern=48895C2408574883EC20488BDA4533C0

[CObList::Construct]
Pattern=8D530A488D8EC04C0000
Operations=ADD 11, PUSH, READ DWORD, ADD, ADD 4

[CObList::Destruct]
Pattern=44396C2468
Operations=ADD 21, PUSH, READ DWORD, ADD, ADD 4

[CObList::RemoveHead]
Pattern=574883EC20488B4108
Operations=ADD -10

[CRes::Construct]
Pattern=66C741500000488901
Operations=ADD -7

[CRes::Demand]
Pattern=488BD94885C9743F
Operations=ADD -6

[CRes::Destruct]
Pattern=4D39A708020000
Operations=ADD -16, PUSH, READ DWORD, ADD, ADD 4

[CSearchBitmap::GetCost]
Pattern=48895C242056574154415541564883EC30

[CString::ConstructFromChars]
Pattern=488BF2488901488BF9
Operations=ADD -17

[CString::Destruct]
Pattern=488B114883C2F4

[CVariableHash::FindKey]
Pattern=4155415641574883EC304C8BF9
Operations=ADD -10

[CompareCResByTypeThenName]
Pattern=488B09488B12

[SDL_GetKeyFromName]
Pattern=488BD94885C90F84F2000000
Operations=ADD -10

[bsearch]
Pattern=488978204155
Operations=ADD -15

[findMenu]
Pattern=4881ECA800000048894C2448

[rand]
Pattern=694828FD430300
Operations=ADD -9

[restoreMenuStack]
Pattern=0F84D701000048899C24B0000000
Operations=ADD -57

[saveMenuStack]
Pattern=85C00F8E01010000
Operations=ADD -31

[uiLoadMenu]
Pattern=4883EC60BA7C000000
Operations=ADD -8

;----------------------
;-- Engine Functions --
;----------------------

[CGameEffect::Construct]
Pattern=4889442428488BD9418BF1
Operations=ADD -23

[CGameEffect::CopyFromBase]
Pattern=488BF2488BF94C8BC2
Operations=ADD -30

[CGameEffect::GetItemEffect]
Pattern=488BF9B930000000
Operations=ADD -10

[operator_new]
Pattern=488BD9EB0F
Operations=ADD -6

;-----------
;-- Hooks --
;-----------

[!ExeSwitch-Baldur.exe-Hook-dimmInit()-uiLoadMenu()]
Pattern=74034C8B30
Operations=ADD 34

[!ExeSwitch-icewind.exe-Hook-dimmInit()-uiLoadMenu()]
Pattern=74034C8B30
Operations=ADD 37

[Data-CGameEffect::vftable]
Pattern=4889442428488BD9418BF1
Operations=ADD 29, PUSH, READ DWORD, ADD, ADD 4

[Data-CInfButtonArray::SetState()-IndirectJumpTable]
Pattern=41C786B01F0000640000004533FF
Operations=ADD 332

[Hook-CAIObjectType::Decode()-DefaultJmp]
Pattern=4885D20F84C6020000
Operations=ADD 33

[Hook-CAIObjectType::Decode()-NormalBranch]
Pattern=488B55D749FFC7
Operations=ADD 4

[Hook-CAIObjectType::Decode()-ReturnBranch]
Pattern=488BB424F00000004C8BBC24A0000000

[Hook-CAIObjectType::Decode()-TargetNameOverride]
Pattern=41837D0CFF
Operations=ADD -6

[Hook-CAIScript::Construct()-OnCopy1]
Pattern=488D5708488BCE
Operations=ADD 7

[Hook-CAIScript::Construct()-OnCopy2]
Pattern=740E488D5608
Operations=ADD 9

[Hook-CAIScript::Destruct()-OnDestruct]
Pattern=75D1488B7C2430
Operations=ADD 11

[Hook-CAIScript::Read()-OnRead]
Pattern=4C8D45F7488945D7
Operations=ADD 27

[Hook-CChitin::OnResizeWindow()-B3Scale]
Pattern=488D542460488B4E20
Operations=ADD 9

[Hook-CChitin::ProcessEvents()-SDL_PollEvent()-1]
Pattern=4889451F488BF9
Operations=ADD 11

[Hook-CChitin::ProcessEvents()-SDL_PollEvent()-2]
Pattern=0F85B3F2FFFF
Operations=ADD -7

[Hook-CDerivedStats::Construct()-FirstCall]
Pattern=48894C24085741544155415641574883EC20488BF1
Operations=ADD 28

[Hook-CDerivedStats::Destruct()-FirstCall]
Pattern=488981500C0000
Operations=ADD 14

[Hook-CDerivedStats::GetAtOffset()-OutOfBoundsJmp]
Pattern=3DC9000000
Operations=ADD 5

[Hook-CDerivedStats::operator_equ()-FirstCall]
Pattern=48894424288B02
Operations=ADD 641

[Hook-CDerivedStats::operator_plus_equ()-FirstCall]
Pattern=4883EC300FB74204
Operations=ADD 75

[Hook-CGameAIBase::EvaluateStatusTrigger()-DefaultJmp]
Pattern=0FBF8550030000
Operations=ADD 17

[Hook-CGameAIBase::ExecuteAction()-DefaultJmp]
Pattern=488BCBFF17
Operations=ADD 31

[Hook-CGameAIBase::ExecuteAction()-NormalBranch]
Pattern=6689B3BA040000
Operations=ADD -5

[Hook-CGameEffect::CheckAdd()-LastProbabilityJmp]
Pattern=48898520010000488B85A0010000
Operations=ADD 94

[Hook-CGameEffect::CheckAdd()-ProbabilityFailed]
Pattern=33C0488B8D20010000

[Hook-CGameEffect::DecodeEffect()-DefaultJmp]
Pattern=5741564883EC4033DB
Operations=ADD 38

[Hook-CGameEffect::DecodeEffect()-Fail]
Pattern=488BD84C8B7C2460
Operations=ADD 3

[Hook-CGameEffect::DecodeEffect()-Success]
Pattern=488BD84C8B7C2460

[Hook-CGameObjectArray::Clean()-DestructJmp]
Pattern=6666660F1F840000000000480FBFC2
Operations=ADD 32

[Hook-CGameObjectArray::Clean()-LastJmp]
Pattern=4881C1006500004883C420
Operations=ADD 12

[Hook-CGameObjectArray::Delete()-DeleteJmp]
Pattern=6642392C37
Operations=ADD 5

[Hook-CGameSprite::AddEffect()-noSave-Override]
Pattern=753585F6
Operations=ADD 4

[Hook-CGameSprite::Construct1()-FirstCall]
Pattern=4889442460488BF1
Operations=ADD 8

[Hook-CGameSprite::Construct2()-FirstCall]
Pattern=488945FF33C0
Operations=ADD 31

[Hook-CGameSprite::Destruct()-FirstCall]
Pattern=75DA4C8DB358490000
Operations=ADD 12

[Hook-CGameSprite::IsOver()-B3Invis]
Pattern=3843387627
Operations=ADD 3

[Hook-CGameSprite::ProcessEffectList()-CDerivedStats::Reload()]
Pattern=488D8660050000660F1F440000
Operations=ADD 37

[Hook-CGameSprite::QuickLoad()-CDerivedStats::Reload()]
Pattern=4C8D8F800B0000
Operations=ADD 31

[Hook-CGameSprite::Render()-B3Invis]
Pattern=3846387613
Operations=ADD 18

[Hook-CGameSprite::RenderMarkers()-B3Invis1]
Pattern=3846387626
Operations=ADD 3

[Hook-CGameSprite::RenderMarkers()-B3Invis2]
Pattern=BA060000004C896C2458
Operations=ADD 46

[Hook-CGameSprite::SetCursor()-SetCharacterToolTip()]
Pattern=80BF38400000FF
Operations=ADD 63

[Hook-CGameSprite::Unmarshal()-CDerivedStats::Reload()-1]
Pattern=FFC63B770C
Operations=ADD 62

[Hook-CGameSprite::Unmarshal()-CDerivedStats::Reload()-2]
Pattern=4C8D8B800B0000498BCD
Operations=ADD 24

[Hook-CInfButtonArray::OnLButtonPressed()-HasFullThieving]
Pattern=488B88901000007402

[Hook-CInfButtonArray::SetState()-CInfButtonArray::UpdateButtons()]
Pattern=41C786B01F0000640000004533FF
Operations=ADD 154

[Hook-CInfButtonArray::SetState()-SaveArg]
Pattern=498D8EF8200000
Operations=ADD -11

[Hook-Infinity_DestroyAnimation()-TemplateMenuOverride]
Pattern=0F848D000000488B4808
Operations=ADD 17

[Hook-Infinity_InstanceAnimation()-TemplateMenuOverride]
Pattern=488BD0488BC8
Operations=ADD 182

[Hook-SDL_main()-CBaldurChitin::Init()]
Pattern=4885C0740D4C8BC3
Operations=ADD 28

[Hook-SDL_main()-CLUAConsole::LuaInit()]
Pattern=C7804010000001000000
Operations=ADD 10

[Hook-dimmInit()-uiLoadMenu()]
ExeSwitch=1
ExeSwitchAlias=SiegeOfDragonspear.exe:Baldur.exe

[Hook-saveMenus()-CheckItemSave]
Pattern=498B1E4885DB0F8482000000
Operations=ADD 25

[Hook-uiRefreshMenu()-restoreMenuStack()]
Pattern=85FF0F8E94000000
Operations=ADD 223

[Hook-uiRefreshMenu()-saveMenuStack()]
Pattern=48C7C7FFFFFFFF6690
Operations=ADD -235

;------------------------------------------
;-- Functions Referenced by Lua Bindings --
;------------------------------------------

[Hardcoded_luaL_loadstring]
Pattern=48894424404889542430
Operations=ADD -14

[Hardcoded_lua_callk]
Pattern=48895C2408574883EC204C8B5110

[Hardcoded_lua_getmetatable]
Pattern=7411498B4218
Operations=ADD -28

[Hardcoded_lua_gettable]
Pattern=4D8BC84883C428
Operations=ADD -26

[Hardcoded_lua_insert]
Pattern=498B53104C8BD0
Operations=ADD -12

[Hardcoded_lua_iscfunction]
Pattern=83F916740C
Operations=ADD -12

[Hardcoded_lua_isnumber]
Pattern=83F9037428
Operations=ADD -12

[Hardcoded_lua_isuserdata]
Pattern=83F947
Operations=ADD -12

[Hardcoded_lua_newuserdata]
Pattern=488BFA488B4918
Operations=ADD -13

[Hardcoded_lua_next]
Pattern=4C8B4310488BCB4983E810
Operations=ADD -14

[Hardcoded_lua_pushboolean]
Pattern=4C8B411033C0

[Hardcoded_lua_pushlightuserdata]
Pattern=488910C7400802000000
Operations=ADD -4

[Hardcoded_lua_pushlstring]
Pattern=488B5310488B742438
Operations=ADD -83

[Hardcoded_lua_rawget]
Pattern=488B53104883EA10488B08
Operations=ADD -14

[Hardcoded_lua_rawgeti]
Pattern=4883EC28458BD0

[Hardcoded_lua_rawseti]
Pattern=4883EC20458BD0
Operations=ADD -6

[Hardcoded_lua_remove]
Pattern=498B4A104883C010
Operations=ADD -12

[Hardcoded_lua_setmetatable]
Pattern=4C8B4B104C8BD0
Operations=ADD -14

[Hardcoded_lua_settable]
Pattern=48834310E04883C420
Operations=ADD -37

[Hardcoded_lua_tocfunction]
Pattern=83F9167508
Operations=ADD -12

[Hardcoded_lua_tonumberx]
Pattern=80F9047554
Operations=ADD -40

[Hardcoded_lua_touserdata]
Pattern=83F9027418
Operations=ADD -15

[Hardcoded_lua_type]
Pattern=4883EC28E8????????488D0D????????483BC1740B

[Hardcoded_tolua_beginmodule]
Pattern=488BD94885D27417
Operations=ADD -6

[Hardcoded_tolua_bnd_cast]
Pattern=488BCB488BF0418D5002
Operations=ADD -33

[Hardcoded_tolua_bnd_release]
Pattern=488BF84885C00F8487000000
Operations=ADD -25

[Hardcoded_tolua_bnd_releaseownership]
Pattern=488BF98D5301
Operations=ADD -12

[Hardcoded_tolua_bnd_takeownership]
Pattern=48896C24104889742418574883EC2033F6

[Hardcoded_tolua_bnd_type]
Pattern=7429BAFFFFFFFF
Operations=ADD 362, PUSH, READ DWORD, ADD, ADD 4

[Hardcoded_tolua_cclass]
Pattern=41574881EC38010000
Operations=ADD -11

[Hardcoded_tolua_constant]
Pattern=40534883EC300F29742420

[Hardcoded_tolua_endmodule]
Pattern=41B8AD030000
Operations=ADD -11897, PUSH, READ DWORD, ADD, ADD 4

[Hardcoded_tolua_error]
Pattern=803A23
Operations=ADD -15

[Hardcoded_tolua_function]
Pattern=BAFDFFFFFF488BCF488B5C2430
Operations=ADD -35

[Hardcoded_tolua_getmetatable]
Pattern=BAD8B9F0FF488BCB4883C420
Operations=ADD -38

[Hardcoded_tolua_isboolean]
Pattern=443BC07C43
Operations=ADD -43

[Hardcoded_tolua_isnumber]
Pattern=443BC07C0E
Operations=ADD -43

[Hardcoded_tolua_isstring]
Pattern=443BC07C3E
Operations=ADD -43

[Hardcoded_tolua_isusertype]
Pattern=48895C240848896C24104889742418574883EC20498BE88BF2

[Hardcoded_tolua_module]
Pattern=4889742410574883EC20418BF0488BFA
Operations=ADD -5

[Hardcoded_tolua_newmetatable]
Pattern=4883EC20488BFA488BD94C8BC2
Operations=ADD -6

[Hardcoded_tolua_pushboolean]
Pattern=4C8B411033C0

[Hardcoded_tolua_pushnumber]
Pattern=488B4110F20F1108

[Hardcoded_tolua_pushstring]
Pattern=41B14C488D542458
Operations=ADD 39, PUSH, READ DWORD, ADD, ADD 4

[Hardcoded_tolua_toboolean]
Pattern=4889742410574883EC20418BD88BFA
Operations=ADD -5

[Hardcoded_tolua_tonumber]
Pattern=0F297424208BDA
Operations=ADD -10

[Hardcoded_tolua_tostring]
Pattern=488BC3488B5C2430488B7424384883C4205FC34533C0
Operations=ADD -43

[Hardcoded_tolua_tousertype]
Pattern=488BC3488B5C2430488B7424384883C4205FC38BD7
Operations=ADD -43

[Hardcoded_tolua_usertype]
Pattern=488BFA89442420
Operations=ADD -37

[Hardcoded_tolua_variable]
Pattern=488BF2498BF9
Operations=ADD -20

[class_index_event]
Pattern=0F85B3020000
Operations=ADD -22

[class_newindex_event]
Pattern=83F8070F85B3010000
Operations=ADD -19

[mapinheritance]
Pattern=498BD8488BF94C8BC2
Operations=ADD -10

[mapsuper]
Pattern=574883EC20488BFA498BF0
Operations=ADD -10

[module_index_event]
Pattern=83F8057561
Operations=ADD -47

[module_newindex_event]
Pattern=83F8057566
Operations=ADD -47

[tolua_cclass]
Pattern=41574881EC38010000
Operations=ADD -11

[tolua_open]
Pattern=83F8010F84D7030000
Operations=ADD -61
